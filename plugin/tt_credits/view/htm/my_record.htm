<?php
	if(empty($uid)) die();
    $num_pid = db_count('user_pay',array('uid'=>$uid));
	$page = param(2,1);
	$data =  db_find('user_pay',array('uid'=>$uid), array('time'=>-1), $page, $pagesize = 20);
	$pagination = pagination(url("my-record-{page}"), $num_pid, $page, $pagesize);
function uid($tid)
{$r = db_find_one('thread',array("tid"=>$tid));return $r['uid'];}

?>
<template include="./plugin/tt_credits/view/htm/my_credits.template.htm">
	<slot name="my_body">
	    <style>
	        .table th{

	            text-align: left;
	            border-bottom: 1px solid #ddd;
	        }
	        .table td{

	            text-align: right;
	        }
	    </style>
	    <table class="table">
		<?php foreach($data as $v) {$c_type = $v['credit_type'];?>
		<tr><th>时间</th>
			<td><?php echo date('m-d H:i',$v['time']); ?></td></tr>
		<tr><th>类型</th>
			<td><?php if($v['nums'] !=0){?>
			提现审核
			<?php }else{ ?>
			<?php echo $g_credits_type_array[$v['type']];?></td><?php }?></tr>
		<tr><th>状态</th>
			<td style="color:<?php if($g_credits_status_array[$v['status']+1] == '成功'){echo 'green';}else{echo 'red';}?>"><?php echo $g_credits_status_array[$v['status']+1];?></td></tr>
		<tr><th>交易</th>
			<td><?php if($v['num']>0) {echo $c_type=='3'?$v['num']:$v['num'],' '.$c_type<=3?lang('credits'.$c_type):'';}else  if($v['nums'] !=0){echo $c_type=='3'?$v['nums']:$v['nums'],' '.$c_type<=3?lang('credits'.$c_type):''; }else{echo '-';} ?></td></tr>
		<tr><th style="border-bottom:1px solid #000;">记录</th>
			<td style="border-bottom:1px solid #000;"><?php if($v['code'] != ','){ ?><?php echo $v['code'];?><?php }else{echo '无记录';}?></td>
		</tr>
		<?php }?></table>
		<nav class="text-center"><ul class="pagination"><?php echo $pagination; ?></ul></nav>
	</slot>
</template>
<script>
    $('a[data-active="my-record"]').addClass('active');
</script>